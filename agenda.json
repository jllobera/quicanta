---
permalink: /agenda.json
layout: null
---

[
{% assign events = site.events | sort: "start" %}
{% for event in events %}
  {% assign venue = site.venues | where: "slug", event.venue | first %}
  {% assign choir_names = "" | split: "" %}
  {% for choir_slug in event.choirs %}
    {% assign choir = site.choirs | where: "slug", choir_slug | first %}
    {% if choir %}
      {% assign choir_names = choir_names | push: choir.name %}
    {% else %}
      {% assign choir_names = choir_names | push: choir_slug %}
    {% endif %}
  {% endfor %}
  {
    "title": {{ event.title | jsonify }},
    "url": {{ event.url | relative_url | jsonify }},
    "start": {{ event.start | jsonify }},
    "choirs": {{ event.choirs | jsonify }},
    "choir_names": {{ choir_names | jsonify }},
    "venue": {{ event.venue | jsonify }},
    "city": {{ venue.city | jsonify }}
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
]
