---
layout: default
---

<article class="event">

  <h2>{{ page.title }}</h2>

  {% if page.start %}
    <p>
      <strong>Date:</strong>
      {{ page.start | date: "%A, %d %B %Y at %H:%M" }}
    </p>
  {% endif %}

  {% if page.venue %}
    {% assign venue = site.venues | where: "slug", page.venue | first %}
    <p>
      <strong>Venue:</strong>
      {% if venue %}
        <a href="{{ venue.url | relative_url }}">
          {{ venue.name }}
        </a>
      {% else %}
        {{ page.venue }}
      {% endif %}
    </p>
  {% endif %}

  {% if page.choirs %}
    <h3>Participating choirs</h3>
    <ul class="event-choirs">
      {% for choir_entry in page.choirs %}
        {% assign choir = site.choirs | where: "slug", choir_entry.slug | first %}
  
        <li class="event-choir">
          {% if choir %}
            <strong>
              <a href="{{ choir.url | relative_url }}">
                {{ choir.name }}
              </a>
            </strong>
          {% else %}
            <strong>{{ choir_entry.slug }}</strong>
          {% endif %}
  
          {%- comment -%}
          Resolve conductors:
          1. event-specific
          2. fallback to choir defaults
          {%- endcomment -%}
          {% if choir_entry.conductors %}
            {% assign conductor_slugs = choir_entry.conductors %}
          {% elsif choir and choir.conductors %}
            {% assign conductor_slugs = choir.conductors %}
          {% else %}
            {% assign conductor_slugs = nil %}
          {% endif %}
  
          {% if conductor_slugs %}
            <div class="event-conductors">
              <span class="label">Conductor{% if conductor_slugs.size > 1 %}s{% endif %}:</span>
              {% for c in conductor_slugs %}
                {% comment %} c can be a string (manual) or object {% endcomment %}
                {% if c.slug %}
                  {% assign conductor = site.people | where: "slug", c.slug | first %}
                  {% if conductor %}
                    <a class="conductor-name" href="{{ conductor.url | relative_url }}">
                      {{ conductor.name }}
                    </a>
                  {% else %}
                    <span class="conductor-name">{{ c.slug }}</span>
                  {% endif %}
                {% elsif c.name %}
                  {% if c.external %}
                    <span class="conductor-name external">{{ c.name }}</span>
                  {% else %}
                    <span class="conductor-name">{{ c.name }}</span>
                  {% endif %}
                {% else %}
                  <span class="conductor-name">{{ c }}</span>
                {% endif %}
                {% unless forloop.last %}, {% endunless %}
              {% endfor %}
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  <div class="description">
    {{ content }}
  </div>

</article>
